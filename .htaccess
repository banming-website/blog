<IfModule mod_rewrite.c>
  RewriteEngine On

  # 静态页面
  RewriteRule ^archive$ archive.php [L]
  RewriteRule ^search$ search.php [L]

  # 文章详情
  RewriteRule ^post/([^/]+)$ post.php?slug=$1 [L,QSA]

  # 页面路由
  RewriteRule ^(about|works|games|music|resources|friends)$ page.php?page=$1 [L]

  # 后台路由
  RewriteRule ^admin$ admin/index.php [L]
  RewriteRule ^admin/([^/]+)$ admin/$1.php [L]

  # API 路由
  RewriteRule ^api/([^/]+)$ api/$1.php [L]

  # RSS
  RewriteRule ^rss$ rss.php [L]

  # 默认首页
  DirectoryIndex index.php
</IfModule>

# 禁止访问敏感文件
<FilesMatch "^(config\.php|content/|includes/|\.env)">
  Order allow,deny
  Deny from all
</FilesMatch>

# 启用 GZIP 压缩
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
</IfModule>

# 设置缓存头
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
</IfModule>
